export EDITOR="nvim"
export GOPATH="$HOME/go"
export PATH="$GOPATH/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/scripts/bin:$PATH"
source ~/.aliases
HISTSIZE=1000

bind Space:magic-space
bind "\C-Space":alias-expand-line
bind '"\C-p":history-search-backward'
bind '"\C-n":history-search-forward'
bind '"\e[A":history-search-backward'
bind '"\e[B":history-search-forward'

bind "set bell-style visible"
bind "set colored-completion-prefix on"
bind "set colored-stats on"
bind "set completion-ignore-case on"
bind "set completion-map-case on"
bind "set show-all-if-ambiguous on"
shopt -s globstar 2> /dev/null
shopt -s autocd 2> /dev/null
shopt -s dirspell 2> /dev/null
shopt -s cdspell 2> /dev/null

prompt_bad_exit () {
  if [[ "$?" != 0 ]]; then
    PS1="${PS1}\e[31m!\e[0m "
  fi
}
prompt_name () {
  PS1="${PS1}\e[32m\u@\h \e[34m\w\e[0m "
}
prompt_git_branch () {
  gitbranch=$(git branch --show-current 2> /dev/null)
  if [[ $gitbranch != "" ]]; then
    PS1="${PS1}\e[31m${gitbranch}\e[0m "
  fi
}
prompt_job_count () {
  jobs=$(jobs | wc -l)
  if [[ $jobs != 0 ]]; then
    PS1="${PS1}\e[33m${jobs}\e[0m "
  fi
}
prompt_arrow () {
  PS1="${PS1}\n\e[32m>\e[0m "
}

if type starship &> /dev/null; then
  eval "$(starship init bash)"
else
  PROMPT_COMMAND=(PS1="" prompt_name prompt_git_branch prompt_bad_exit prompt_job_count prompt_arrow)
fi


if type zoxide &> /dev/null; then
	eval "$(zoxide init bash)"
fi

upd () {
  if type pacman &> /dev/null; then
    pacsyu
    if type yay &> /dev/null; then
      yay -Syua
    fi
  fi
  if type apt &> /dev/null; then
    aptu
  fi
  if type dnf &> /dev/null; then
    dnfu
  fi
  if type zypper &> /dev/null; then
    zypu
  fi
  if type flatpak &> /dev/null; then
    flatu
  fi
}

d () {
  if [[ $1 == '' ]]; then
    PS3='Select a directory: '
    oldifs=$IFS
    IFS=$'\n'
    select var in $(dirs -p)
    do
      \cd ${var/\~/"$HOME"}
      break
    done
    IFS=$oldifs
  else
    pushd $1 &> /dev/null
  fi
}
